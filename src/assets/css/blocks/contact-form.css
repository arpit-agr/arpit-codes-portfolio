.contact-form {
	--_form-max-width: 48rem;
	--_form-row-gap: var(--space-m-l);
	--_form-column-gap: calc(2 * var(--_form-spacing));
	--_form-spacing: var(--space-s-m);
	--_color-form-bg: var(--color-bg);
	/* this value is hardcoded in the textarea svg background */
	--_color-form-border: var(--color-text);
	--_form-border-width: var(--border-normal);

	--box-padding: var(--_form-spacing);
	--box-border-thickness: var(--_form-border-width);
	--color-box-border: var(--_color-form-border);
	--sidebar-gap: var(--_form-row-gap) var(--_form-column-gap);

	position: relative;
	max-inline-size: var(--_form-max-width);
	margin-inline: auto;
	background: var(--_color-form-bg);
	overflow: clip; /* why: the paper texture is overflowing on Chrome  */
	/* rotate: -2deg; */

	/* TODO: do I still need this? */
	&::before {
		content: "";
		position: absolute;
		inset-inline-start: 0;
		inset-block-start: 0;
		inline-size: 100%;
		block-size: 100%;
		filter: url(#roughpaper);
		mix-blend-mode: hard-light;
		opacity: 0.0125;
		pointer-events: none;
		z-index: -1;
	}

	> * {
		--flow-space: var(--input-padding);
	}

	input,
	button,
	textarea {
		padding: unset;
	}

	input,
	button {
		padding-block: var(--input-padding);
	}

	input,
	textarea {
		border: none;
		border-radius: unset;
		background-color: #0000;
	}

	label {
		font-size: var(--step--1);
		text-transform: uppercase;
		letter-spacing: var(--tracking-wide);
	}

	input,
	textarea:not(:placeholder-shown),
	.recipient {
		font-family: var(--font-handwritten);
		letter-spacing: var(--tracking-wide);
	}
}

.metadata {
	--stack-horizontal-alignment: stretch;
	--stack-vertical-alignment: space-between;
	--stack-gap: var(--sidebar-gap);

	position: relative;
	block-size: 100%;

	&::after {
		content: "";
		position: absolute;
		inset-inline-end: 0;
		inset-block-start: calc(-1 * var(--_form-spacing));
		inline-size: var(--_form-border-width);
		block-size: calc(100% + (2 * var(--_form-spacing)));
		background: var(--_color-form-border);
		translate: calc(0.5 * var(--_form-column-gap)) 0;
		/* opacity: 0.5; */

		@container (width > 50vi) {
			display: none;
		}
	}
}

.postage-stamp-container {
	float: inline-end;
	margin-inline-start: 1em;
	outline: var(--_form-border-width) dashed var(--_color-form-border);
	aspect-ratio: 1;

	img {
		max-block-size: 3.5lh;
		inline-size: auto;
		rotate: 10deg;
		scale: 1.01;
		filter: brightness(0.8) contrast(2.5);
		mix-blend-mode: luminosity;
	}
}

.recipient {
	font-size: var(--step-1);
	rotate: -1deg;
	translate: 0.25ch 0;
}

.sender {
	--grid-gap: var(--flow-space) 1ch;
	grid-template-columns: auto minmax(0, 1fr);

	> * {
		grid-column: 1/-1;

		display: grid;
		grid-template-columns: subgrid;
		align-items: center;
	}

	input:-webkit-autofill {
		-webkit-box-shadow: 0 0 0px 1000px var(--_color-form-bg) inset;
	}

	:has(> input) {
		border-block-end: var(--_form-border-width) dashed var(--_color-form-border);
	}
}

.correspondence {
	--stack-horizontal-alignment: stretch;
	--stack-gap: var(--input-padding);

	* {
		inline-size: 100%;
	}

	.correspondence-inner,
	textarea {
		flex-grow: 9999;
	}

	textarea {
		background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="28.8px">\<line x1="0" y1="1" x2="100%" y2="1" stroke="%230d0d0d" stroke-dasharray="2.5, 2.5" />\</svg>');
		background-repeat: repeat-y;
		background-size: auto 1lh;

		@media (prefers-color-scheme: dark) {
			background-image: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="100%" height="28.8px">\<line x1="0" y1="1" x2="100%" y2="1" stroke="%23ecdd85" stroke-dasharray="2.5, 2.5" />\</svg>');
		}
	}

	textarea:not([rows]) {
		min-block-size: 6lh;
	}

	button {
		background-color: var(--color-btn-bg);
		transition-property: color, background-color, outline-color;
		transition-duration: var(--transition-duration);

		&:not(:focus-visible) {
			outline: var(--_form-border-width) solid var(--_color-form-border);
		}

		&:hover,
		&:focus-visible {
			background-color: var(--color-btn-hover-bg);
			color: var(--color-btn-hover-text);
			outline-color: var(--color-btn-hover-bg);
			-webkit-font-smoothing: antialiased;

			@media (prefers-color-scheme: dark) {
				-webkit-font-smoothing: auto;
			}
		}
	}
}
